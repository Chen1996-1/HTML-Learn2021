<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<style>
  #one {
    height: 100px;
  }
  #two {
    position: relative;
  }
  #imgs-list {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(4, 1fr);
    margin: 0 100px;
    width: 400px;
    height: 400px;
    border-bottom: 1px solid black;
    border-right: 1px solid black;
  }
  #img {
    height: 100px;
    width: 100px;
    border-top: 1px solid black;
    border-left: 1px solid black;
    box-sizing: border-box;
  }
  #cap-black {
    position: absolute;
    top: 50px;
    left: 150px;
    background-color: red;
    height: 200px;
    width: 200px;

  }
  span {
    color: #fff;
  }
</style>
</head>
<body>
  <div id="one">
    <input id="inputList"> 输入列表
    <button id="submitButton">提交</button>
    <div id="output"></div>
  </div>
  <div id="two">
    <div id="imgs-list" ref='imgs'>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
      <div id="img"></div>
    </div>
    <div id="cap-black" @mousemove="loadImges" @click="cancelMove" ref="cap">
      <span v-for="(imgName,index) in imgsList" :key="index">{{imgName}}</span>
    </div>
    <button id="imgsload" style=height:40px;" @click="loadImges">点我</button>
  </div>
</body>
<script>
  var imgAp = new Vue({
    el: '#two',
    data(){
      return {
        imgsList:{

        },
        timer: null
      }
    },
    methods: {
      cancelMove(cl) {
        // cap.Ele.style.top = window.getComputedStyle(this.$refs['cap']).top
        // cap.Ele.style.left= window.getComputedStyle(this.$refs['cap']).left
        this.show = false
        // console.log('cancel')
      },

      loadImges(el) {
        const capEle = this.$refs.cap
        const capEleSty = window.getComputedStyle(this.$refs['cap'])
        const capWidth = eval(capEle.clientWidth)
        const capHeight =eval(capEle.clientHeight)

        const imgsListEle = this.$refs.imgs
        const imgsListWidth= imgsListEle.clientWidth
        const imgsListHeight= imgsListEle.clientHeight
        const imgsListLFPointX= imgsListEle.getBoundingClientRect().x
        const imgsListLFPointY= imgsListEle.getBoundingClientRect().y
        const imgsListRBPointX= imgsListLFPointX + imgsListWidth 
        const imgsListRBPointY= imgsListLFPointY + imgsListHeight

        const imgeSize = 100
      



        

        // console.log(capWidth, capHeight)
        let mouseX = el.clientX
        let mouseY = el.clientY

        let capLTPointX = mouseX - capWidth/2
        let capLTPointY = mouseY - capHeight/2
        let capRBPointX = mouseX + capWidth/2
        let capRBPointY = mouseY + capHeight/2

        if (mouseX >= (imgsListLFPointX-capWidth/3) && mouseX <= (imgsListRBPointX + capHeight/3) && mouseY >= (imgsListLFPointY - capWidth/3) && mouseY <= (imgsListRBPointY + capWidth/3)) {
            let tX = mouseX - capWidth/2
            let lY = mouseY - capHeight/2 - 100
            capEle.style.top = lY +'px'
            capEle.style.left = tX + 'px'
            let list = []
            let imgsLTX = (capLTPointX) <= imgsListLFPointX ? Math.floor(imgsListLFPointX/imgeSize) : Math.floor(capLTPointX/imgeSize)
            let imgsLTY = (capLTPointY) <= imgsListLFPointY ? Math.floor(imgsListLFPointY/imgeSize) : Math.floor(capLTPointY/imgeSize)
            let imgsRBX = (capRBPointX) >= imgsListRBPointX ? Math.floor(imgsListRBPointX/imgeSize): Math.ceil(capRBPointX/imgeSize)
            let imgsRBY = (capRBPointY) >= imgsListRBPointY ? Math.floor(imgsListRBPointY/imgeSize)  :Math.ceil(capRBPointY/imgeSize) 

            for (let i=imgsLTX; i< imgsRBX; i++) {
              for (let j=imgsLTY; j< imgsRBY; j++) {
                
                list.push([i,j])
              }
            }

            this.imgsList= list.map((item) => {
            return item.join('-') + '.png'
            })

        }
      }
    },
  })



  const inputListEle = document.getElementById('inputList')
  const submitEle = document.getElementById('submitButton')
  const outputEle = document.getElementById('output')
  // const listSour = [3,1,2,1,3,3,4,5,6,5]

  submitEle.onclick = function (){ 
    var listSour = inputListEle.value.split(',')
    l = repList(listSour);
    console.log(l);
    outputEle.innerHTML = l

  }

  function repList (arr) {
    var obj= {}
    var onelist = []
    var resultList = []

    for (i=0; i< arr.length; i++) {
      item = arr[i]
      obj[item] = obj[item] + 1 || 1
    
      if (!(onelist.includes(item))) {
        onelist.push(item)
      }
      else {
        id = onelist.indexOf(item)
        resultList[id]=item
      }
    }
    var l = []
    for (i=0; i<resultList.length; i++) {
      item = resultList[i]
      for (j = 0; j < obj[item]; j++){
        l.push(item)
      }
    }
    return l
  }




</script>
</html>